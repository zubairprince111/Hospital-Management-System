@{
    var title = ViewData["Title"] as string ?? "Hospital Management System";
}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@title - Hospital Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="bg-body d-flex">
    <aside class="sidebar bg-primary text-white">
        <div class="sidebar-header d-flex align-items-center justify-content-between px-3 py-3">
            <a class="navbar-brand fw-bold text-white text-decoration-none" asp-controller="Home" asp-action="Index">
                <span class="me-2">ğŸ¥</span>Hospital
            </a>
        </div>
        <nav class="nav flex-column px-2 sidebar-nav">
            @if (User.Identity?.IsAuthenticated == true)
            {
                <a class="nav-link text-white" asp-controller="Admin" asp-action="Dashboard">
                    <span class="me-2">ğŸ“Š</span>Dashboard
                </a>
                <a class="nav-link text-white" asp-controller="Patients" asp-action="Index">
                    <span class="me-2">ğŸ‘¥</span>Patients
                </a>
                <a class="nav-link text-white" asp-controller="Doctors" asp-action="Index">
                    <span class="me-2">ğŸ©º</span>Doctors
                </a>
                <a class="nav-link text-white" asp-controller="Appointments" asp-action="Index">
                    <span class="me-2">ğŸ“…</span>Appointments
                </a>
                <a class="nav-link text-white" asp-controller="Tasks" asp-action="Index">
                    <span class="me-2">âœ…</span>Tasks
                </a>
                <a class="nav-link text-white" asp-controller="Notifications" asp-action="Index">
                    <span class="me-2">ğŸ””</span>Notifications
                    @if (ViewBag.UnreadNotifications != null && ViewBag.UnreadNotifications > 0)
                    {
                        <span class="badge bg-danger ms-2">@ViewBag.UnreadNotifications</span>
                    }
                </a>
                @if (User.IsInRole("Administrator") || User.IsInRole("Manager"))
                {
                    <a class="nav-link text-white" asp-controller="Reports" asp-action="Index">
                        <span class="me-2">ğŸ“ˆ</span>Reports
                    </a>
                    <a class="nav-link text-white" asp-controller="AuditLogs" asp-action="Index">
                        <span class="me-2">ğŸ“‹</span>Audit Logs
                    </a>
                }
                @if (User.IsInRole("Administrator"))
                {
                    <a class="nav-link text-white" asp-controller="Users" asp-action="Index">
                        <span class="me-2">ğŸ‘¤</span>Users
                    </a>
                }
            }
            else
            {
                <a class="nav-link text-white" asp-controller="Home" asp-action="Index">
                    <span class="me-2">ğŸ </span>Home
                </a>
            }
        </nav>
        <div class="sidebar-footer mt-auto px-3 pb-3 small text-white-50">
            &copy; @DateTime.Now.Year HMS
        </div>
    </aside>

    <div class="app-main d-flex flex-column flex-grow-1">
        <header class="app-topbar d-flex justify-content-between align-items-center px-3 py-2 border-bottom bg-white">
            <div class="fw-semibold">@title</div>
            <div class="d-flex align-items-center gap-2">
                @if (User.Identity?.IsAuthenticated == true)
                {
                    <span class="text-muted small">@User.Identity.Name (@User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value)</span>
                    <form asp-controller="Admin" asp-action="Logout" method="post" class="d-inline">
                        <button type="submit" class="btn btn-sm btn-outline-danger">Logout</button>
                    </form>
                }
                <button id="themeToggle" type="button" class="btn btn-sm btn-outline-secondary">
                    ğŸŒ / ğŸŒ™
                </button>
            </div>
        </header>

        <main class="flex-grow-1 p-3">
            @RenderBody()
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        (function () {
            const root = document.documentElement;
            const btn = document.getElementById('themeToggle');
            const stored = localStorage.getItem('hms-theme');
            if (stored) {
                root.setAttribute('data-theme', stored);
            }
            function applyTheme(theme) {
                root.setAttribute('data-theme', theme);
                localStorage.setItem('hms-theme', theme);
            }
            btn?.addEventListener('click', function () {
                const current = root.getAttribute('data-theme') || 'light';
                applyTheme(current === 'light' ? 'dark' : 'light');
            });
        })();
    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>


